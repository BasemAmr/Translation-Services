const e={business:{base:.12,complexity:1},legal:{base:.18,complexity:1.4},medical:{base:.2,complexity:1.6},technical:{base:.16,complexity:1.3},marketing:{base:.14,complexity:1.1}},n={standard:1,express:1.5,urgent:2,rush:2.5},t=[{min:0,max:1e3,discount:0},{min:1001,max:5e3,discount:.05},{min:5001,max:1e4,discount:.1},{min:10001,max:25e3,discount:.15},{min:25001,max:1/0,discount:.2}],i=({documentType:i,wordCount:r,urgency:s,additionalServices:o=[]})=>{const d=e[i]||e.business,c=n[s]||1,l=r*d.base*d.complexity,u=l*c,m=t.find(e=>r>=e.min&&r<=e.max)?.discount||0,p=u*m,h=u-p,g=o.reduce((e,n)=>{switch(n){case"certification":return e+.15*h;case"proofreading":return e+.1*h;case"formatting":return e+.08*h;case"rush-delivery":return e+.25*h;default:return e}},0),v=h+g;return{basePrice:Math.round(100*l)/100,urgentPrice:Math.round(100*u)/100,discountAmount:Math.round(100*p)/100,volumeDiscount:m,subtotal:Math.round(100*h)/100,servicesTotal:Math.round(100*g)/100,total:Math.round(100*v)/100,deliveryTime:a(s,r)}},a=(e,n)=>{const t={standard:Math.ceil(n/2e3),express:Math.ceil(n/3e3),urgent:1,rush:.5};return Math.max(t[e]||3,"rush"===e?.5:1)};class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.state=Object.freeze({formData:{documentType:"business",wordCount:1e3,urgency:"standard",additionalServices:[]},pricing:i({documentType:"business",wordCount:1e3,urgency:"standard"}),isCalculating:!1,animationId:null,currency:this.getAttribute("data-currency")||"USD"}),this.commandHandlers=new Map,this.setupCommandHandlers()}connectedCallback(){this.render(),this.bindEvents(),this.startNumberAnimations()}disconnectedCallback(){this.state.animationId&&cancelAnimationFrame(this.state.animationId)}setupCommandHandlers(){this.commandHandlers.set("UPDATE_FIELD",this.handleFieldUpdate.bind(this)),this.commandHandlers.set("TOGGLE_SERVICE",this.handleServiceToggle.bind(this)),this.commandHandlers.set("CALCULATE_PRICE",this.handlePriceCalculation.bind(this)),this.commandHandlers.set("ANIMATE_NUMBER",this.handleNumberAnimation.bind(this))}dispatch(e,n){const t=this.commandHandlers.get(e);t&&t(n)}handleFieldUpdate({field:e,value:n}){const t={...this.state.formData,[e]:"wordCount"===e?parseInt(n)||0:n};this.setState({formData:t,pricing:i(t),isCalculating:!0}),setTimeout(()=>{this.setState({isCalculating:!1}),this.animateNumbers()},300)}handleServiceToggle({service:e}){const n=this.state.formData.additionalServices,t=n.includes(e)?n.filter(n=>n!==e):[...n,e],a={...this.state.formData,additionalServices:t};this.setState({formData:a,pricing:i(a)}),this.animateNumbers()}handlePriceCalculation(){this.setState({isCalculating:!0,pricing:i(this.state.formData)}),setTimeout(()=>{this.setState({isCalculating:!1}),this.animateNumbers()},500)}handleNumberAnimation({element:e,targetValue:n,duration:t=1e3}){const i=parseFloat(e.textContent)||0,a=performance.now(),r=s=>{const o=s-a,d=Math.min(o/t,1),c=(l=d,1-Math.pow(1-l,3));var l;const u=i+(n-i)*c;e.textContent=this.formatCurrency(u),d<1&&this.setState({animationId:requestAnimationFrame(r)})};requestAnimationFrame(r)}setState(e){const n="function"==typeof e?e(this.state):{...this.state,...e};this.state=Object.freeze(n),this.updateUI()}updateUI(){this.updatePricingDisplay(),this.updateProgressBars(),this.updateFormValues()}render(){this.shadowRoot.innerHTML='\n        <style>\n          :host {\n            display: block;\n            padding: 0;\n          }\n          \n          .calculator-wrapper {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 0 2rem;\n          }\n          \n          .calculator-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 0;\n            background: white;\n            border-radius: 24px;\n            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n          }\n          \n          .form-section {\n            padding: 2.5rem;\n            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n          }\n          \n          .results-section {\n            padding: 2.5rem;\n            background: var(--primary-blue, #1E40AF);\n            color: white;\n            position: relative;\n            overflow: hidden;\n          }\n          \n          .results-section::before {\n            content: \'\';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);\n            pointer-events: none;\n          }\n          \n          .section-title {\n            font-size: 1.5rem;\n            font-weight: 700;\n            margin-bottom: 2rem;\n            color: var(--neutral-dark, #1F2937);\n          }\n          \n          .results-section .section-title {\n            color: white;\n          }\n          \n          .form-group {\n            margin-bottom: 2rem;\n          }\n          \n          .form-label {\n            display: block;\n            font-weight: 600;\n            margin-bottom: 0.5rem;\n            color: var(--neutral-dark, #1F2937);\n          }\n          \n          .form-input {\n            width: 100%;\n            padding: 1rem;\n            border: 2px solid #e2e8f0;\n            border-radius: 12px;\n            font-size: 1rem;\n            transition: all 0.3s ease;\n            background: white;\n          }\n          \n          .form-input:focus {\n            outline: none;\n            border-color: var(--primary-blue, #1E40AF);\n            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);\n          }\n          \n          .slider-container {\n            position: relative;\n            margin: 1rem 0;\n          }\n          \n          .slider {\n            width: 100%;\n            height: 8px;\n            border-radius: 4px;\n            background: #e2e8f0;\n            outline: none;\n            -webkit-appearance: none;\n          }\n          \n          .slider::-webkit-slider-thumb {\n            -webkit-appearance: none;\n            appearance: none;\n            width: 24px;\n            height: 24px;\n            border-radius: 50%;\n            background: var(--primary-blue, #1E40AF);\n            cursor: pointer;\n            box-shadow: 0 4px 8px rgba(30, 64, 175, 0.3);\n          }\n          \n          .slider-value {\n            position: absolute;\n            top: -40px;\n            transform: translateX(-50%);\n            background: var(--neutral-dark, #1F2937);\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 20px;\n            font-size: 0.875rem;\n            font-weight: 600;\n          }\n          \n          .services-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 1rem;\n          }\n          \n          .service-card {\n            padding: 1.5rem;\n            background: white;\n            border: 2px solid #e2e8f0;\n            border-radius: 16px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            text-align: center;\n          }\n          \n          .service-card:hover {\n            border-color: var(--primary-blue, #1E40AF);\n            transform: translateY(-2px);\n            box-shadow: 0 10px 20px rgba(30, 64, 175, 0.1);\n          }\n          \n          .service-card.selected {\n            background: var(--primary-blue, #1E40AF);\n            color: white;\n            border-color: var(--primary-blue, #1E40AF);\n          }\n          \n          .pricing-breakdown {\n            position: relative;\n            z-index: 10;\n          }\n          \n          .price-item {\n            display: flex;\n            justify-content: space-between;\n            padding: 1rem 0;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n          }\n          \n          .price-item:last-child {\n            border-bottom: none;\n            font-size: 1.25rem;\n            font-weight: 700;\n            margin-top: 1rem;\n            padding-top: 1.5rem;\n            border-top: 2px solid rgba(255, 255, 255, 0.3);\n          }\n          \n          .price-value {\n            font-weight: 600;\n            transition: all 0.3s ease;\n          }\n          \n          .price-value.calculating {\n            opacity: 0.6;\n            animation: pulse 1s infinite;\n          }\n          \n          @keyframes pulse {\n            0%, 100% { opacity: 0.6; }\n            50% { opacity: 1; }\n          }\n          \n          .delivery-estimate {\n            background: rgba(255, 255, 255, 0.1);\n            padding: 1.5rem;\n            border-radius: 16px;\n            margin-top: 2rem;\n            text-align: center;\n          }\n          \n          .delivery-time {\n            font-size: 2rem;\n            font-weight: 700;\n            margin-bottom: 0.5rem;\n          }\n          \n          .cta-button {\n            width: 100%;\n            padding: 1.25rem;\n            background: var(--accent-gold, #D97706);\n            color: white;\n            border: none;\n            border-radius: 16px;\n            font-size: 1.1rem;\n            font-weight: 700;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            margin-top: 2rem;\n          }\n          \n          .cta-button:hover {\n            background: #b45309;\n            transform: translateY(-2px);\n            box-shadow: 0 10px 20px rgba(180, 83, 9, 0.3);\n          }\n          \n          /* Chart visualization */\n          .price-chart {\n            height: 200px;\n            margin: 2rem 0;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 16px;\n            position: relative;\n            overflow: hidden;\n          }\n          \n          .chart-bar {\n            position: absolute;\n            bottom: 0;\n            background: var(--accent-gold, #D97706);\n            border-radius: 4px 4px 0 0;\n            transition: height 0.8s cubic-bezier(0.4, 0, 0.2, 1);\n          }\n          \n          /* Responsive design */\n          @media (max-width: 768px) {\n            .calculator-wrapper {\n              padding: 0 1rem;\n            }\n            \n            .calculator-container {\n              grid-template-columns: 1fr;\n              gap: 0;\n            }\n            \n            .form-section, .results-section {\n              padding: 1.5rem;\n            }\n            \n            .services-grid {\n              grid-template-columns: 1fr;\n            }\n          }\n        </style>\n        \n        <div class="calculator-wrapper">\n          <div class="section-header" style="text-align: center; margin-bottom: 2rem;">\n            <h2 style="font-size: 2.5rem; font-weight: 700; color: var(--neutral-dark, #1F2937); margin-bottom: 1rem;">Get Your Instant Quote</h2>\n            <p style="font-size: 1.125rem; color: #6B7280; max-width: 600px; margin: 0 auto; line-height: 1.6;">\n              Transparent pricing with instant estimates. No hidden fees, no surprises.\n            </p>\n          </div>\n          \n          <div class="calculator-container">\n            \x3c!-- Form Section --\x3e\n            <div class="form-section">\n              <h3 class="section-title">Project Details</h3>\n              \n              <div class="form-group">\n                <label class="form-label" for="documentType">Document Type</label>\n                <select class="form-input" id="documentType" name="documentType">\n                  <option value="business">Business Documents</option>\n                  <option value="legal">Legal Translation</option>\n                  <option value="medical">Medical Translation</option>\n                  <option value="technical">Technical Documentation</option>\n                  <option value="marketing">Marketing Materials</option>\n                </select>\n              </div>\n              \n              <div class="form-group">\n                <label class="form-label" for="wordCount">Word Count</label>\n                <div class="slider-container">\n                  <input type="range" class="slider" id="wordCount" name="wordCount"\n                         min="100" max="50000" value="1000" step="100">\n                  <div class="slider-value" id="wordCountValue">1,000</div>\n                </div>\n                <input type="number" class="form-input" id="wordCountInput" name="wordCountInput"\n                       min="1" value="1000" placeholder="Enter word count">\n              </div>\n              \n              <div class="form-group">\n                <label class="form-label" for="urgency">Delivery Time</label>\n                <select class="form-input" id="urgency" name="urgency">\n                  <option value="standard">Standard (3-5 days)</option>\n                  <option value="express">Express (1-2 days)</option>\n                  <option value="urgent">Urgent (24 hours)</option>\n                  <option value="rush">Rush (12 hours)</option>\n                </select>\n              </div>\n              \n              <div class="form-group">\n                <label class="form-label">Additional Services</label>\n                <div class="services-grid">\n                  <div class="service-card" data-service="certification">\n                    <div>📜</div>\n                    <h4>Certification</h4>\n                    <p>+15%</p>\n                  </div>\n                  <div class="service-card" data-service="proofreading">\n                    <div>🔍</div>\n                    <h4>Proofreading</h4>\n                    <p>+10%</p>\n                  </div>\n                  <div class="service-card" data-service="formatting">\n                    <div>🎨</div>\n                    <h4>Formatting</h4>\n                    <p>+8%</p>\n                  </div>\n                  <div class="service-card" data-service="rush-delivery">\n                    <div>⚡</div>\n                    <h4>Rush Delivery</h4>\n                    <p>+25%</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            \x3c!-- Results Section --\x3e\n            <div class="results-section">\n              <h3 class="section-title">Price Breakdown</h3>\n              \n              <div class="pricing-breakdown">\n                <div class="price-item">\n                  <span>Base Price</span>\n                  <span class="price-value" id="basePrice">$120.00</span>\n                </div>\n                <div class="price-item">\n                  <span>Urgency Fee</span>\n                  <span class="price-value" id="urgencyFee">$0.00</span>\n                </div>\n                <div class="price-item">\n                  <span>Volume Discount</span>\n                  <span class="price-value" id="volumeDiscount">-$0.00</span>\n                </div>\n                <div class="price-item">\n                  <span>Additional Services</span>\n                  <span class="price-value" id="servicesTotal">$0.00</span>\n                </div>\n                <div class="price-item">\n                  <span>Total</span>\n                  <span class="price-value" id="totalPrice">$120.00</span>\n                </div>\n              </div>\n              \n              <div class="price-chart" id="priceChart"></div>\n              \n              <div class="delivery-estimate">\n                <div class="delivery-time" id="deliveryTime">3-5</div>\n                <div>Business Days</div>\n              </div>\n              \n              <button class="cta-button" id="getQuoteBtn">\n                Get Detailed Quote\n              </button>\n            </div>\n          </div>\n        </div>\n      '}bindEvents(){const e=this.shadowRoot;e.getElementById("documentType").addEventListener("change",e=>{this.dispatch("UPDATE_FIELD",{field:"documentType",value:e.target.value})});const n=e.getElementById("wordCount"),t=e.getElementById("wordCountInput");n.addEventListener("input",i=>{const a=i.target.value;t.value=a,e.getElementById("wordCountValue").textContent=this.formatNumber(a),this.updateSliderPosition(n,e.getElementById("wordCountValue")),this.dispatch("UPDATE_FIELD",{field:"wordCount",value:a})}),t.addEventListener("input",t=>{const i=Math.min(Math.max(t.target.value,1),5e4);n.value=i,e.getElementById("wordCountValue").textContent=this.formatNumber(i),this.updateSliderPosition(n,e.getElementById("wordCountValue")),this.dispatch("UPDATE_FIELD",{field:"wordCount",value:i})}),e.getElementById("urgency").addEventListener("change",e=>{this.dispatch("UPDATE_FIELD",{field:"urgency",value:e.target.value})}),e.querySelectorAll(".service-card").forEach(e=>{e.addEventListener("click",()=>{const n=e.getAttribute("data-service");e.classList.toggle("selected"),this.dispatch("TOGGLE_SERVICE",{service:n})})}),e.getElementById("getQuoteBtn").addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("quote-requested",{detail:{formData:this.state.formData,pricing:this.state.pricing},bubbles:!0}))})}updatePricingDisplay(){const{pricing:e}=this.state,n=this.shadowRoot,t={basePrice:n.getElementById("basePrice"),urgencyFee:n.getElementById("urgencyFee"),volumeDiscount:n.getElementById("volumeDiscount"),servicesTotal:n.getElementById("servicesTotal"),totalPrice:n.getElementById("totalPrice"),deliveryTime:n.getElementById("deliveryTime")};this.state.isCalculating?Object.values(t).forEach(e=>e?.classList.add("calculating")):(Object.values(t).forEach(e=>e?.classList.remove("calculating")),t.basePrice.textContent=this.formatCurrency(e.basePrice),t.urgencyFee.textContent=this.formatCurrency(e.urgentPrice-e.basePrice),t.volumeDiscount.textContent="-"+this.formatCurrency(e.discountAmount),t.servicesTotal.textContent=this.formatCurrency(e.servicesTotal),t.totalPrice.textContent=this.formatCurrency(e.total),t.deliveryTime.textContent=.5===e.deliveryTime?"12 hrs":1===e.deliveryTime?"1":`${Math.ceil(e.deliveryTime)}`)}updateProgressBars(){this.renderPriceChart()}updateFormValues(){const e=this.shadowRoot,{formData:n}=this.state;e.getElementById("documentType").value=n.documentType,e.getElementById("wordCount").value=n.wordCount,e.getElementById("wordCountInput").value=n.wordCount,e.getElementById("urgency").value=n.urgency,e.querySelectorAll(".service-card").forEach(e=>{const t=e.getAttribute("data-service");n.additionalServices.includes(t)?e.classList.add("selected"):e.classList.remove("selected")})}renderPriceChart(){const e=this.shadowRoot.getElementById("priceChart"),{pricing:n}=this.state,t=Math.max(n.basePrice,n.urgentPrice,n.total);e.innerHTML=`\n        <div class="chart-bar" style="\n          left: 10%; \n          width: 20%; \n          height: ${n.basePrice/t*80}%;\n          background: rgba(255,255,255,0.6);\n        "></div>\n        <div class="chart-bar" style="\n          left: 40%; \n          width: 20%; \n          height: ${n.urgentPrice/t*80}%;\n          background: var(--accent-gold, #D97706);\n        "></div>\n        <div class="chart-bar" style="\n          left: 70%; \n          width: 20%; \n          height: ${n.total/t*80}%;\n          background: #10B981;\n        "></div>\n      `}animateNumbers(){["basePrice","totalPrice"].forEach(e=>{const n=this.shadowRoot.getElementById(e);if(n){parseFloat(n.textContent.replace(/[$,]/g,""));const t="basePrice"===e?this.state.pricing.basePrice:this.state.pricing.total;this.dispatch("ANIMATE_NUMBER",{element:n,targetValue:t,duration:800})}})}startNumberAnimations(){setTimeout(()=>this.animateNumbers(),500)}updateSliderPosition(e,n){const t=(e.value-e.min)/(e.max-e.min)*100;n.style.left=`${t}%`}formatCurrency(e){const n=this.state.currency;return new Intl.NumberFormat("en-US",{style:"currency",currency:n,minimumFractionDigits:2}).format(e)}formatNumber(e){return new Intl.NumberFormat("en-US").format(e)}}customElements.define("pricing-calculator",r);export{r as PricingCalculator};